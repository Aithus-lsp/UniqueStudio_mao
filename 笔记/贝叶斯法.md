贝叶斯法及其联想
===

> 注:这里,属性,特征包含输出.

规律总结或描述方法:

* ${P ( c | x )}$ = $\frac{P(x | c) * P(c)}{P(x)}$

* 统计规律假设

---

0.概论(算法讨论范围的延展)
---

所有多数监督都是相关成分的之间依赖关系的描述.算法通过不同方法应用统计假设挖掘这种描述,这些描述以相同方式反应,并加以利用.因此,贝叶斯算法在使用贝叶斯原理之时,根据不同的依赖假设(或者说是不依赖假设),可以分为三类,朴素贝叶斯算法,半贝叶斯算法,贝叶斯网.

另外,不要将讨论固定在所谓输入,输出之上,虽然对所有数据特征的依赖关系的讨论(犹对于朴素贝叶斯与大多数其他算法)是没有实用意义的,但这有利于建立一种思想.进一步说,这是更像是一种哲学,我愿意将它理解为机器学习或者数据挖掘的基础,即世间所以事物之间存在由强到弱的联系,数据挖掘本身就是在已知数据的基础上,避开那些弱的联系,以强联系获取未知.

这就又引申到了另外一方面,即规律的总结,不论是物理规律,生物规律或者是市场规律,事实上都来自于统计(经验),又需要加以验证,同时,对规律的描述又有不同方式,如文字,数学公式等.这些,推广到机器学习上:规律总结对应于整个机器学习范畴,但更观照于模型训练,而规律验证对应于机器学习中的验证,不同的规律描述方法对应于不同的学习模型.

再进一步,人类也是经验的混合,机器学习再进一步的关键是,学习模型的自我发现.或者是经验处理的改造.

---

1.各种贝叶斯法
---

1. 朴素贝叶斯法

    假设"输出"依赖于所有特征(这里不另外去除自身依赖,虽然这是没有意义的),且假设输入之间不互相依赖.

2. 半贝叶斯法

    假设输出依赖于所有属性.适当考虑其他依赖.典型的有SPODE, TAN, AODE.

3. 贝叶斯网

    假设属性之间相互依赖,而其中的重要的依赖由一张网络(即贝叶斯网)描述.

> 因为所以贝叶斯法都可以看做贝叶斯网的延续, 简化版, 故以下只对贝叶斯网做讨论.同时,公式也要相应的转换为
$P( C | pa_1, pa_2 ... pa_i ... pa_n) =$ $\frac {P(pa_1, pa_2 ... pa_i ... pa_n | C) * P(C) } {P(pa_1, pa_2 ... pa_i ... pa_n)}$

---

2.对贝叶斯原理的理解
---

开始时以为是纯粹的公式, 后来越想越糊.

理解贝叶斯公式有两种途径.

1. 联合概率分布的转换公式
    原来,对于独立的事件,可得    **:**
    >$P(x, y) = P(y) * P(x)$
    
    但是当事件独立不适用的时候(这种情况在现实生活中更为常见),需要相应转换  **:**
    >$P(x, y) = P(y) * P( x | y ) = P(x) * P( y | x)$

    当已知发生变化时, 就可以对右边两项进行转化,及得贝叶斯公式.

2. $P(Y | X)$又可表示在X事件对Y事件的影响,即$P(Y)$在$X$的影响下转换为$P(Y | X)$,这时,公式最好写成:

 >$P(X_i | Y) =$ $\frac{P(Y | X_i) * P( X_i )}{\sum P(Y|X_i)*P(X_I)}$


3.贝叶斯结构的选择
---

1. 评估准则
    一般使用信息论准则与极大似然函数:
    ${LOSS =}$ $\sum log P ( x_i )$ $+ f( \theta ) |B|$
    > $f ( \theta )$ : 每一网络参数对应的平均字节数
    $|B|$ : 参数数
    $P( x_i )$ : 概率

2. 用于选择的模型
    对所有模型选择是一个NP难问题, 故只好妥协, 可固定结构(缩减选择范围)或使用贪心算法(减少选择步骤).

简而言之, 贝叶斯结构选择是在一个缩减的网络集合中利用评估准则取最优.

---

4.贝叶斯方法的实现
---

在取得训练模型后就要加以利用, 这里又是一个NP难问题, 故需要使用吉布斯漫步. 不断的更新改善数据, 但是, 这种假设只能作用于单一缺失值, 于是,又要使用EM算法.

##### 4.1.EM算法(同时这也是参数训练的重要方法)

1. 基于当前参数(或初始化的参数)推测隐变量的概率分布, 并求对数似然函数关于隐变量的期望
2. 寻找参数最大化的期望似然, 更新, 不断迭代.

##### 4.2.吉布斯漫步

补全样本后不断使用贝叶斯网络更新(依据基于其他变量影响概率随机依次更新特征值), 有证明, 一定次数后样本收敛于正确.(但是,证据过少时其结果必是不准确的).

---

5.一些深入概念
---

贝叶斯网由有向无环图表示,直接反应了属性之间的依赖关系,同时间接反应了属性之间的独立关系,同时,可以应用有向分离将图转换为无向图,更为直观的反应属性之间的依赖独立关系